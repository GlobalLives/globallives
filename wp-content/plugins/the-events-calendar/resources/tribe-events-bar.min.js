var tribe_events_bar_action;
(function(v,p,c,e,k,q,b,m,n){c(p).ready(function(){function r(a){if(!a.parents(".tribe-bar-disabled").length){var b=a.width();800<b?a.removeClass("tribe-bar-mini tribe-bar-collapse").addClass("tribe-bar-full"):a.removeClass("tribe-bar-full").addClass("tribe-bar-mini");728>b?a.removeClass("tribe-bar-mini").addClass("tribe-bar-collapse"):a.removeClass("tribe-bar-collapse")}}function s(){tribe_events_bar_action="change_view";if("month"===b.view&&d.length){var a=d.val(),e=q.get_day();"0"!==b.datepicker_format?
e.length?(a=tribeDateFormat(d.bootstrapDatepicker("getDate"),"tribeMonthQuery"),d.val(a+e)):d.val(""):7===a.length&&d.val(a+e)}b.url_params={};c(k).trigger("tribe_ev_preCollectBarParams");c("#tribe-bar-form input, #tribe-bar-form select").each(function(){var a=c(this);a.val().length&&!a.hasClass("tribe-no-param")&&("month"!==b.view&&"0"!==b.datepicker_format&&a.is(d)?b.url_params[a.attr("name")]=tribeDateFormat(a.bootstrapDatepicker("getDate"),"tribeQuery"):a.is(":checkbox")?a.is(":checked")&&(b.url_params[a.attr("name")]=
a.val()):b.url_params[a.attr("name")]=a.val())});b.url_params=c.param(b.url_params);c(k).trigger("tribe_ev_postCollectBarParams");b.url_params.length&&(b.cur_url+=m.starting_delim()+b.url_params);v.location.href=b.cur_url}n&&(c().bootstrapDatepicker||debug.warn("TEC Debug: vendor bootstrapDatepicker was not loaded before its dependant file tribe-events-bar.js"),c().placeholder||debug.warn("TEC Debug: vendor placeholder was not loaded before its dependant file tribe-events-bar.js"));var f=c("#tribe-bar-form"),
d=c("#tribe-bar-date");c("#tribe-events");var g=c("select[name=tribe-bar-view]");r(f);f.resize(function(){r(f)});if(!c(".tribe-events-week-grid").length&&"month"!==b.view){var h="yyyy-mm-dd";if("0"!==b.datepicker_format){var h=e.datepicker_formats.main[b.datepicker_format],t=q.get_url_param("tribe-bar-date");t?d.val(tribeDateFormat(t,b.datepicker_format)):"day"===b.view&&0!==d.val().length&&d.val(tribeDateFormat(d.val(),b.datepicker_format))}n&&debug.info('TEC Debug: bootstrapDatepicker was just initialized in "tribe-events-bar.js" on:',
d);e.datepicker_opts={format:h,autoclose:!0};d.bootstrapDatepicker(e.datepicker_opts)}d.blur(function(){""===d.val()&&(c(".datepicker.dropdown-menu").is(":hidden")&&m.live_ajax()&&m.pushstate)&&(b.date=e.cur_date,e.cur_url=e.base_url,c(k).trigger("tribe_ev_runAjax"))});c(".tribe-bar-settings").length&&c("#tribe-events-bar").addClass("tribe-has-settings");c("#tribe-events-bar .hasDatepicker").length&&c("#tribe-events-bar").addClass("tribe-has-datepicker");c('input[name*="tribe-bar-"]').placeholder();
c('<ul class="tribe-bar-views-list" />').insertAfter(g);h=c(".tribe-bar-views-list");g.find("option").each(function(a){var b=c(this);displaying=b.data("view");var d="tribe-bar-views-option-"+b.data("view");c("<li></li>",{"class":"tribe-bar-views-option "+d,"data-tribe-bar-order":a,"data-view":displaying}).html(['   <a href="#">','   <span class="tribe-icon-'+displaying+'">'+b.text()+"</span>","</a>"].join("")).appendTo(".tribe-bar-views-list")});g=g.find(":selected").data("view");h.find("li[data-view="+
g+"]").prependTo(h).addClass("tribe-bar-active");f.on("click","#tribe-bar-views",function(a){a.stopPropagation();c(this).toggleClass("tribe-bar-views-open")});f.on("click",".tribe-bar-views-option",function(a){a.preventDefault();a=c(this);a.is(".tribe-bar-active")||(a=a.data("view"),b.cur_url=c("option[data-view="+a+"]").val(),b.view_target=c('select[name=tribe-bar-view] option[value="'+b.cur_url+'"]').data("view"),tribe_events_bar_action="change_view",s())});f.on("change",".tribe-bar-views-select",
function(a){a.preventDefault();a=c("option:selected",this).data("view");b.cur_url=c("option[data-view="+a+"]").val();b.view_target=c('select[name=tribe-bar-view] option[value="'+b.cur_url+'"]').data("view");tribe_events_bar_action="change_view";s()});f.on("click","#tribe-bar-collapse-toggle",function(){c(this).toggleClass("tribe-bar-filters-open");c(".tribe-bar-filters").slideToggle("fast")});c('label[for="tribe-bar-date"], input[name="tribe-bar-date"]').wrapAll('<div id="tribe-bar-dates" />');c("#tribe-bar-filters").before(c("#tribe-bar-dates"));
c(k).on("tribe_ev_serializeBar",function(){c("form#tribe-bar-form input, form#tribe-bar-form select, #tribeHideRecurrence").each(function(){var a=c(this);a.is("#tribe-bar-date")&&(a.val().length?"month"===b.view?(b.params[a.attr("name")]=tribeDateFormat(b.mdate,"tribeMonthQuery"),b.url_params[a.attr("name")]=tribeDateFormat(b.mdate,"tribeMonthQuery")):(b.params[a.attr("name")]=tribeDateFormat(a.bootstrapDatepicker("getDate"),"tribeQuery"),b.url_params[a.attr("name")]=tribeDateFormat(a.bootstrapDatepicker("getDate"),
"tribeQuery")):a.is(".placeholder")&&a.is(".bd-updated")?b.url_params[a.attr("name")]=a.attr("data-oldDate"):b.date=e.cur_date);a.val().length&&(!a.hasClass("tribe-no-param")&&!a.is("#tribe-bar-date"))&&(a.is(":checkbox")?a.is(":checked")&&(b.params[a.attr("name")]=a.val(),"map"!==b.view&&(b.url_params[a.attr("name")]=a.val()),("month"===b.view||"day"===b.view||"week"===b.view||b.recurrence)&&b.pushcount++):(b.params[a.attr("name")]=a.val(),"map"!==b.view&&(b.url_params[a.attr("name")]=a.val()),("month"===
b.view||"day"===b.view||"week"===b.view)&&b.pushcount++))})});var l=c('#tribe-events-bar [class^="tribe-bar-button-"]'),u=l.next(".tribe-bar-drop-content");l.click(function(){var a=c(this);a.toggleClass("open");a.next(".tribe-bar-drop-content").toggle();return!1});c(p).click(function(){c("#tribe-bar-views").removeClass("tribe-bar-views-open");l.hasClass("open")&&(l.removeClass("open"),u.hide())});u.click(function(a){a.stopPropagation()});n&&debug.info("TEC Debug: tribe-events-bar.js successfully loaded")})})(window,
document,jQuery,tribe_ev.data,tribe_ev.events,tribe_ev.fn,tribe_ev.state,tribe_ev.tests,tribe_debug);
